(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84101,e=>{"use strict";var r=e.i(99493),s=e.i(72648),l=e.i(89737);let t=[{month:"Jan",sales:12e5},{month:"Feb",sales:15e5},{month:"Mar",sales:13e5},{month:"Apr",sales:17e5},{month:"May",sales:16e5},{month:"Jun",sales:19e5}];var a=e.i(30631);let o=(0,a.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),d=(0,a.default)("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]),n=(0,a.default)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var i=e.i(36627),c=e.i(48274);let m=({onEdit:e,onDelete:l,refreshTrigger:t})=>{let[a,o]=(0,s.useState)([]),d=async()=>{try{let e=await fetch("/api/products");if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);let r=await e.json();o(r)}catch(e){console.error("Failed to fetch products:",e)}};return(0,s.useEffect)(()=>{d()},[t]),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Manage Products"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full bg-white",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Name"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Brand"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Category"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Stock"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b text-right",children:"Regular Price"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b text-right",children:"Wholesaler Price"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b text-right",children:"Distributor Price"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b text-right",children:"Admin Price"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:a.map(s=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:s.name}),(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:s.brand}),(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:s.category}),(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:s.stock_qty}),(0,r.jsxs)("td",{className:"py-2 px-4 border-b text-right",children:["₹",s.pricing[c.UserRole.REGULAR]?.toFixed(2)||"N/A"]}),(0,r.jsxs)("td",{className:"py-2 px-4 border-b text-right",children:["₹",s.pricing[c.UserRole.WHOLESALER]?.toFixed(2)||"N/A"]}),(0,r.jsxs)("td",{className:"py-2 px-4 border-b text-right",children:["₹",s.pricing[c.UserRole.DISTRIBUTOR]?.toFixed(2)||"N/A"]}),(0,r.jsxs)("td",{className:"py-2 px-4 border-b text-right",children:["₹",s.pricing[c.UserRole.ADMIN]?.toFixed(2)||"N/A"]}),(0,r.jsxs)("td",{className:"py-2 px-4 border-b",children:[(0,r.jsx)("button",{onClick:()=>e(s),className:"text-emerald-600 hover:underline mr-4",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>l(s.id),className:"text-red-600 hover:underline",children:"Delete"})]})]},s.id))})]})})]})},x=({product:e,onSave:l,onClose:t})=>{let[a,o]=(0,s.useState)(e||{pricing:{[c.UserRole.REGULAR]:0,[c.UserRole.WHOLESALER]:0,[c.UserRole.DISTRIBUTOR]:0,[c.UserRole.ADMIN]:0},moq:1,stock_qty:0});(0,s.useEffect)(()=>{o(e||{pricing:{[c.UserRole.REGULAR]:0,[c.UserRole.WHOLESALER]:0,[c.UserRole.DISTRIBUTOR]:0,[c.UserRole.ADMIN]:0},moq:1,stock_qty:0})},[e]);let d=e=>{let{name:r,value:s}=e.target;o(e=>({...e,[r]:s}))},n=e=>{let{name:r,value:s}=e.target;o(e=>{let l={[c.UserRole.REGULAR]:0,[c.UserRole.WHOLESALER]:0,[c.UserRole.DISTRIBUTOR]:0,[c.UserRole.ADMIN]:0};return{...e,pricing:{...l,...e.pricing,[r]:Number(s)}}})};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:e?"Edit Product":"Add New Product"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l(a)},className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Product Name"}),(0,r.jsx)("input",{type:"text",name:"name",value:a.name||"",onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),(0,r.jsx)("input",{type:"text",name:"brand",value:a.brand||"",onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Pack Size"}),(0,r.jsx)("input",{type:"text",name:"pack_size",value:a.pack_size||"",onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,r.jsx)("input",{type:"text",name:"category",value:a.category||"",onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Image URL"}),(0,r.jsx)("input",{type:"text",name:"image",value:a.image||"",onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity"}),(0,r.jsx)("input",{type:"number",name:"stock_qty",value:a.stock_qty||0,onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Minimum Order Quantity (MOQ)"}),(0,r.jsx)("input",{type:"number",name:"moq",value:a.moq||1,onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]})]}),(0,r.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,r.jsx)("legend",{className:"text-sm font-medium text-gray-700 px-2",children:"Pricing"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Regular"}),(0,r.jsx)("input",{type:"number",name:c.UserRole.REGULAR,value:a.pricing?.[c.UserRole.REGULAR]||0,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Wholesaler"}),(0,r.jsx)("input",{type:"number",name:c.UserRole.WHOLESALER,value:a.pricing?.[c.UserRole.WHOLESALER]||0,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Distributor"}),(0,r.jsx)("input",{type:"number",name:c.UserRole.DISTRIBUTOR,value:a.pricing?.[c.UserRole.DISTRIBUTOR]||0,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Admin"}),(0,r.jsx)("input",{type:"number",name:c.UserRole.ADMIN,value:a.pricing?.[c.UserRole.ADMIN]||0,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4 mt-8",children:[(0,r.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",className:"px-4 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700",children:[e?"Update":"Save"," Product"]})]})]})]})})},u=()=>{let{token:e,currentRole:l}=(0,i.useRole)(),[t,a]=(0,s.useState)([]),[o,d]=(0,s.useState)(!0),[n,m]=(0,s.useState)(null),[x,u]=(0,s.useState)(!1),h=async()=>{if(!e||l!==c.UserRole.ADMIN){m("Unauthorized access"),d(!1);return}d(!0),m(null);try{let r=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${e}`,"X-User-Role":l}});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to fetch users")}let s=await r.json();a(s)}catch(e){m(e.message),console.error("Error fetching users:",e)}finally{d(!1)}};(0,s.useEffect)(()=>{h()},[e,l,x]);let p=async(r,s)=>{if(!e||l!==c.UserRole.ADMIN)return void alert("Unauthorized to change roles.");if(window.confirm(`Are you sure you want to change the role of ${r} to ${s}?`))try{let t=await fetch(`/api/admin/users/${r}/role`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,"X-User-Role":l},body:JSON.stringify({role:s})});if(t.ok)alert(`User ${r} role updated to ${s} successfully!`),u(e=>!e);else{let e=await t.json();throw Error(e.message||"Failed to update user role")}}catch(e){alert(`Error updating role: ${e.message}`),console.error("Error updating user role:",e)}};return o?(0,r.jsx)("div",{className:"text-center py-8",children:"Loading users..."}):n?(0,r.jsxs)("div",{className:"text-center py-8 text-red-600",children:["Error: ",n]}):e&&l===c.UserRole.ADMIN?(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"User Management"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full bg-white",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Email"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Company Name"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Current Role"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:t.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:e.email}),(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:e.companyName||"N/A"}),(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:(0,r.jsx)("select",{value:e.role,onChange:r=>p(e.id,r.target.value),className:"border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:Object.values(c.UserRole).map(e=>(0,r.jsx)("option",{value:e,children:e},e))})}),(0,r.jsx)("td",{className:"py-2 px-4 border-b"})]},e.id))})]})})]}):(0,r.jsx)("div",{className:"text-center py-8 text-red-600",children:"Access Denied: Admin login required."})};e.s(["default",0,()=>{let{currentRole:e,loading:a}=(0,i.useRole)(),[h,p]=(0,s.useState)(null),[b,g]=(0,s.useState)(!1),[y,f]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),v=(0,l.useRouter)(),w=e=>{f(e),g(!0)},R=()=>{g(!1),f(null)};if((0,s.useEffect)(()=>{a||e===c.UserRole.ADMIN||v.push("/admin/login")},[e,a,v]),a||e!==c.UserRole.ADMIN)return(0,r.jsx)("div",{className:"container mx-auto px-4 py-20 text-center",children:(0,r.jsx)("p",{className:"text-lg text-gray-600",children:"Loading admin panel or redirecting..."})});let U=async r=>{try{let s;if((s=r.id?await fetch(`/api/products/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-User-Role":e},body:JSON.stringify(r)}):await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json","X-User-Role":e},body:JSON.stringify(r)})).ok)console.log("Product saved successfully!"),N(e=>!e),R();else{let e=await s.json();console.error("Failed to save product:",e.message||s.statusText),alert(`Failed to save product: ${e.message||s.statusText}`)}}catch(e){console.error("Error saving product:",e),alert("An error occurred while saving the product.")}},k=async r=>{if(window.confirm("Are you sure you want to delete this product?"))try{let s=await fetch(`/api/products/${r}`,{method:"DELETE",headers:{"X-User-Role":e}});if(s.ok)console.log("Product deleted successfully!"),N(e=>!e);else{let e=await s.json();console.error("Failed to delete product:",e.message||s.statusText),alert(`Failed to delete product: ${e.message||s.statusText}`)}}catch(e){console.error("Error deleting product:",e),alert("An error occurred while deleting the product.")}};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Admin Dashboard"}),(0,r.jsxs)("button",{onClick:()=>w(null),className:"bg-emerald-600 text-white font-semibold px-4 py-2 rounded-md hover:bg-emerald-700 transition-colors flex items-center",children:[(0,r.jsx)(n,{size:20,className:"mr-2"}),"Add New Product"]})]}),(0,r.jsx)(m,{onEdit:e=>w(e),onDelete:k,refreshTrigger:j}),b&&(0,r.jsx)(x,{product:y,onSave:U,onClose:R}),(0,r.jsx)(u,{}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow mb-8",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,r.jsx)(o,{className:"w-6 h-6 text-blue-500 mr-2"})," Bulk Inventory Upload (Excel)"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("input",{type:"file",accept:".xlsx, .xls",onChange:e=>{e.target.files&&e.target.files.length>0?p(e.target.files[0]):p(null)},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-emerald-50 file:text-emerald-700 hover:file:bg-emerald-100"}),(0,r.jsx)("button",{onClick:()=>{h?(alert(`Simulating upload of ${h.name}. (Actual upload logic not implemented)`),p(null)):alert("Please select an Excel file to upload.")},disabled:!h,className:"px-6 py-2 bg-emerald-600 text-white font-semibold rounded-lg shadow-md hover:bg-emerald-700 disabled:bg-gray-400 transition-colors",children:"Upload"})]}),h&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Selected file: ",h.name]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow mb-8",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,r.jsx)(d,{className:"w-6 h-6 text-purple-500 mr-2"})," Monthly Sales Overview"]}),(0,r.jsx)("div",{className:"h-64 w-full bg-gray-50 rounded-lg p-4 flex items-end justify-around",children:t.map(e=>(0,r.jsxs)("div",{className:"flex flex-col items-center h-full justify-end",children:[(0,r.jsx)("div",{className:"bg-purple-400 rounded-t-md w-8 hover:bg-purple-600 transition-colors",style:{height:`${e.sales/Math.max(...t.map(e=>e.sales))*90}%`},title:`Sales in ${e.month}: ₹${e.sales.toLocaleString()}`}),(0,r.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.month})]},e.month))}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-4",children:"(This is a simplified chart. In a real application, a charting library would be used.)"})]})]})}],84101)}]);